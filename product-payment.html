<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order - Artisan Bakery</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-bread-slice"></i>
                <span>Artisan Bakery</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="auth.html" class="nav-link" id="authLink">Login</a>
                </li>
                <li class="nav-item">
                    <a href="profile.html" class="nav-link" id="profileLink" style="display: none;">Profile</a>
                </li>
                <li class="nav-item">
                    <a href="about.html" class="nav-link">About Us</a>
                </li>
                <li class="nav-item">
                    <a href="products.html" class="nav-link">Products</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Product Payment Page -->
    <section class="product-payment-page">
        <div class="container">
            <h2>Complete Your Order</h2>
            <p style="text-align: center; color: #666; margin-bottom: 3rem;">Order your fresh artisan bread</p>
            
            <div class="product-payment-container">
                <!-- Product Details -->
                <div class="product-details-section">
                    <h3><i class="fas fa-bread-slice"></i> Product Details</h3>
                    <div id="productInfo">
                        <!-- Product information will be loaded here -->
                    </div>
                </div>

                <!-- Order Form -->
                <div class="order-form-section">
                    <h3><i class="fas fa-shopping-cart"></i> Order Information</h3>
                    
                    <form id="productOrderForm">
                        <!-- Quantity -->
                        <div class="form-group">
                            <label for="quantity">Quantity</label>
                            <select id="quantity" name="quantity" required>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>

                        <!-- Delivery Information -->
                        <h4 style="color: #8B4513; margin: 2rem 0 1rem; border-bottom: 2px solid #8B4513; padding-bottom: 0.5rem;">Delivery Information</h4>
                        
                        <div class="form-group">
                            <label for="deliveryDate">Delivery Date *</label>
                            <input type="date" id="deliveryDate" name="deliveryDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="deliveryTime">Delivery Time *</label>
                            <select id="deliveryTime" name="deliveryTime" required>
                                <option value="">Select Time Slot</option>
                                <option value="morning">Morning (8:00 AM - 12:00 PM)</option>
                                <option value="afternoon">Afternoon (12:00 PM - 4:00 PM)</option>
                                <option value="evening">Evening (4:00 PM - 8:00 PM)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="specialInstructions">Special Instructions (optional)</label>
                            <textarea id="specialInstructions" name="specialInstructions" rows="3" placeholder="Any special delivery instructions..."></textarea>
                        </div>

                        <!-- Payment Method -->
                        <h4 style="color: #8B4513; margin: 2rem 0 1rem; border-bottom: 2px solid #8B4513; padding-bottom: 0.5rem;">Payment Method</h4>
                        
                        <div class="form-group">
                            <label for="paymentMethod">Payment Method *</label>
                            <select id="paymentMethod" name="paymentMethod" required>
                                <option value="">Select Payment Method</option>
                                <option value="cash">Cash on Delivery</option>
                                <option value="card">Credit/Debit Card</option>
                                <option value="paypal">PayPal</option>
                                <option value="bank">Bank Transfer</option>
                            </select>
                        </div>

                        <!-- Order Summary -->
                        <div class="order-summary">
                            <h4>Order Summary</h4>
                            <div id="orderSummary">
                                <!-- Order summary will be calculated here -->
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%; font-size: 1.2rem; padding: 15px;">
                            <i class="fas fa-check"></i> Place Order
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Artisan Bakery</h3>
                    <p>Bringing you the finest artisan breads with traditional recipes and modern convenience.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="products.html">Products</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="auth.html">Login</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <p><i class="fas fa-phone"></i> +49 123 456 7890</p>
                    <p><i class="fas fa-envelope"></i> info@artisanbakery.de</p>
                    <p><i class="fas fa-map-marker-alt"></i> Berlin, Germany</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Artisan Bakery. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Product payment page specific JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            loadProductInfo();
            setupFormHandlers();
        });

        function loadProductInfo() {
            const productData = JSON.parse(localStorage.getItem('selectedProduct')) || {};
            
            if (!productData.name) {
                showNotification('No product selected');
                setTimeout(() => {
                    window.location.href = 'products.html';
                }, 2000);
                return;
            }

            const productInfoDiv = document.getElementById('productInfo');
            productInfoDiv.innerHTML = `
                <div class="product-card-large">
                    <img src="${productData.image}" alt="${productData.name}">
                    <div class="product-details">
                        <h3>${productData.name}</h3>
                        <p>${productData.description}</p>
                        <div class="product-features">
                            ${productData.features ? productData.features.map(feature => 
                                `<span class="feature-tag">${feature}</span>`
                            ).join('') : ''}
                        </div>
                        <div class="product-price">â‚¬${productData.price}</div>
                    </div>
                </div>
            `;

            updateOrderSummary();
        }

        function setupFormHandlers() {
            const quantitySelect = document.getElementById('quantity');
            const form = document.getElementById('productOrderForm');

            quantitySelect.addEventListener('change', updateOrderSummary);

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                processOrder();
            });

            // Set minimum delivery date to tomorrow
            const deliveryDateInput = document.getElementById('deliveryDate');
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            deliveryDateInput.min = tomorrow.toISOString().split('T')[0];
        }

        function updateOrderSummary() {
            const productData = JSON.parse(localStorage.getItem('selectedProduct')) || {};
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            const unitPrice = parseFloat(productData.price) || 0;
            const total = unitPrice * quantity;

            const orderSummaryDiv = document.getElementById('orderSummary');
            orderSummaryDiv.innerHTML = `
                <div class="summary-item">
                    <span>${productData.name} x${quantity}</span>
                    <span>â‚¬${(unitPrice * quantity).toFixed(2)}</span>
                </div>
                <div class="summary-total">
                    <strong>Total: â‚¬${total.toFixed(2)}</strong>
                </div>
            `;
        }

        function processOrder() {
            const productData = JSON.parse(localStorage.getItem('selectedProduct')) || {};
            const formData = new FormData(document.getElementById('productOrderForm'));
            
            const orderData = {
                id: Date.now(), // Generate unique order ID
                product: productData,
                quantity: parseInt(formData.get('quantity')),
                deliveryDate: formData.get('deliveryDate'),
                deliveryTime: formData.get('deliveryTime'),
                specialInstructions: formData.get('specialInstructions'),
                paymentMethod: formData.get('paymentMethod'),
                totalAmount: parseFloat(productData.price) * parseInt(formData.get('quantity')),
                status: 'delivered',
                createdAt: new Date().toISOString()
            };

            showNotification('Processing your order...');
            
            setTimeout(() => {
                // Save order to localStorage
                let orders = JSON.parse(localStorage.getItem('userOrders')) || [];
                orders.unshift(orderData); // Add new order to beginning
                localStorage.setItem('userOrders', JSON.stringify(orders));
                
                showNotification('Order placed successfully! Thank you for your purchase.');
                
                // Clear selected product
                localStorage.removeItem('selectedProduct');
                
                // Redirect to profile page
                setTimeout(() => {
                    window.location.href = 'profile.html';
                }, 2000);
            }, 2000);
        }
    </script>
</body>
</html>
